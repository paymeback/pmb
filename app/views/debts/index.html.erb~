<!-- Checks if a user is logged in -->
<% if current_user %>
<h3>Gesamtschuldenliste:</h3>

<!--Löschen der bishierigen Daten und ausführen der Methoden-->
<%= killdoublesandcross %>
<%= circle %>

<table class="table table-hover table-condensed">
  <tr>
    <th>Value</th>
    <th>Other Currancies<br>Last update: <%= Exchange.find(1).updated_at.to_s(:short)%> (UTC) </th>
    <th>Description</th>
    <th>Debitor</th>
    <th>Creditor</th>
    <!--<th>Cleared</th>-->
    <th>Expiration Date</th>
    <th></th>
    <th></th>
    <th></th>
  </tr>
	
	<% Debt.where('cleared = ?',false).each do |debt| %>

  <tr>
    <td><%= debt.value %></td>
    <td><%= (@dollar * debt.value).round(2) %> (US-Dollar)<br>
	<%= (@yen * debt.value).round(2)  %> (Yen) <br>
	<%= (@pound * debt.value).round(2)  %> (Pound)<br>
	<%= (@rubbel * debt.value).round(2)  %> (Rubbel) <br>
</td>
    <td><%= debt.description %></td>
    <td><%= debt.debitor.nickname %></td>
    <td><%= debt.creditor.nickname %></td>
    <!--<td><%= debt.cleared %></td>-->
    <td><%= if debt.ex_date != nil; debt.ex_date.strftime('%d.%m.%Y'); end %></td>
    <td><%= link_to 'Show', debt %></td>
    <td><%= link_to 'Edit', edit_debt_path(debt) %></td>	
    <td><% if ((debt.creditor_id == current_user.id) and debt.cleared);if can?(:destroy, Debt)%>
	<%= link_to 'Destroy', debt, method: :delete, data: { confirm: 'Are you sure?' }%><%end;end%>
    </td>
  <%end%>
  </tr>
</table>

<!-- Tabelle nach Auflösung der direkten Gleichheiten und Kreuzungen !!!!!!-->

<h3>Zusammengefasst heißt das:</h3>
<table class="table table-hover table-condensed">
  <tr>
    <th>Value</th>
    <th>Debitor</th>
    <th>Creditor</th>
  </tr>
	
	<% Debtniceview.where('').each do |debtniceview| %>

  <tr>
    <td><%= debtniceview.value %></td>
    <td><%= User.find(debtniceview.debitor_id).nickname %></td>
    <td><%= User.find(debtniceview.creditor_id).nickname %></td>
  <%end%>
  </tr>
</table>

<!-- In Worten: !!!!!!-->
<h3>Das heißt in Worten:</h3>
<% Debtniceview.where('').each do |debtniceview| %>

<%= User.find(debtniceview.debitor_id).nickname %> schuldet <%= User.find(debtniceview.creditor_id).nickname %> noch <%= debtniceview.value %> €.</br> 
<%end%>

<!-- In Worten nach Auflösung der Schuldenkreise (3er, 4er, 5er Ketten):-->
<h3>Nach Auflösung der Schuldenkreise heißt das:</h3>
<% Debtcycle.where('').each do |debtcycle| %>

<%= User.find(debtcycle.debitor_id).nickname %> schuldet <%= User.find(debtcycle.creditor_id).nickname %> noch <%= debtcycle.value %> €.</br> 
<%end%>

<h3>Für Dich heißt das:</h3>
<% Debtcycle.where('debitor_id = ?', current_user.id).each do |debtcycle| %>
Du schuldest <%= User.find(debtcycle.creditor_id).nickname %> noch <%= debtcycle.value %> €.</br> 
<%end%>
<% Debtcycle.where('creditor_id = ?', current_user.id).each do |debtcycle| %>
<%= User.find(debtcycle.debitor_id).nickname %> schuldet Dir noch <%= debtcycle.value %> €.</br> 
<%end%>
<%end%>
<br />

