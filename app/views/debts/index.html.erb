<!-- Checks if a user is logged in -->
<% if current_user %>
<h3>Gesamtschuldenliste:</h3>

<!--Löschen der bishierigen Daten und ausführen der Methoden-->
<%= killdoublesandcross %>
<%= circle %>

<table class="table table-hover table-condensed">
  <tr>
    <th>Value</th>
    <th>Other Currancies</th>
    <th>Description</th>
    <th>Debitor</th>
    <th>Creditor</th>
    <!--<th>Cleared</th>-->
    <th>Expiration Date</th>
    <th></th>
    <th></th>
    <th></th>
  </tr>
	
	<% Debt.where('creditor_id = ? and cleared = ? or debitor_id =? and cleared = ?',current_user.id,false,current_user.id,false).each do |debt| %>

  <tr>
    <td><%= debt.value %></td>
    <td><%= (Exchange.find(1).value * debt.value).round(2) %> (US-Dollar)<br>
	<%= (Exchange.find(2).value * debt.value).round(2) %> (Yen) <br>
	<%= (Exchange.find(3).value * debt.value).round(2) %> (Pound)<br>
	<%= (Exchange.find(4).value * debt.value).round(2) %> (Rubbel) <br>
</td>
    <td><%= debt.description %></td>
    <td><%= User.find(debt.debitor_id).nickname %></td>
    <td><%= User.find(debt.creditor_id).nickname %></td>
    <!--<td><%= debt.cleared %></td>-->
    <td><%= if debt.ex_date != nil; debt.ex_date.strftime('%d.%m.%Y'); end %></td>
    <td><%= link_to 'Show', debt %></td>
    <td><%= link_to 'Edit', edit_debt_path(debt) %></td>	
    <td><% if can?(:destroy, Debt) %>
	<%= link_to 'Destroy', debt, method: :delete, data: { confirm: 'Are you sure?' } %><%end%>
    </td>
  <%end%>
  </tr>
</table>

<!-- Tabelle nach Auflösung der direkten Gleichheiten und Kreuzungen !!!!!!-->

<h3>Zusammengefasst heißt das:</h3>
<table class="table table-hover table-condensed">
  <tr>
    <th>Value</th>
    <th>Debitor</th>
    <th>Creditor</th>
  </tr>
	
	<% Debtniceview.where('creditor_id = ? or debitor_id =?',current_user.id,current_user.id).each do |debtniceview| %>

  <tr>
    <td><%= debtniceview.value %></td>
    <td><%= User.find(debtniceview.debitor_id).nickname %></td>
    <td><%= User.find(debtniceview.creditor_id).nickname %></td>
  <%end%>
  </tr>
</table>

<!-- In Worten: !!!!!!-->
<h3>Das heißt in Worten:</h3>
<% Debtniceview.where('creditor_id = ? or debitor_id =?',current_user.id,current_user.id).each do |debtniceview| %>

<%= User.find(debtniceview.debitor_id).nickname %> schuldet <%= User.find(debtniceview.creditor_id).nickname %> noch <%= debtniceview.value %> €.</br> 
<%end%>

<!-- In Worten nach Auflösung der Schuldenkreise (3er, 4er, 5er Ketten):-->
<h3>Nach Auflösung der Schuldenkreise (3er, 4er, 5er Ketten) heißt das:</h3>
<% Debtcycle.where('creditor_id = ? or debitor_id =?',current_user.id,current_user.id).each do |debtcycle| %>

<%= User.find(debtcycle.debitor_id).nickname %> schuldet <%= User.find(debtcycle.creditor_id).nickname %> noch <%= debtcycle.value %> €.</br> 
<%end%>



<%end%>
<br />

